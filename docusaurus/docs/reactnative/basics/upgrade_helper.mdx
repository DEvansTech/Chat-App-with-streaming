---
id: upgrade-helper
title: Upgrading from V3
---

import pinMessageAction from '../assets/basics/upgrade-helper/pin_message_action.png';
import pinnedMessage from '../assets/basics/upgrade-helper/pinned_message.png';

## Add a required `threadList` prop

Add a `threadList` prop on `Channel` component which wraps the Thread component as following:

(This change is only required if you use `Thread` component within your application. )

```tsx
<Channel
  channel={channel}
  thread={thread}
  threadList
>
    <Thread />
  </View>
</Channel>
```

## Update the `Channel` props

Some of the props have been dropped since v4 release.

### `mutesEnabled`

This prop was used to configure visibility of "Mute User" action within message overlay, and has been removed in v4.
Please check [Mute User Action](#mute-user-action) section for details.

### `handleMute`

This prop was used to add non-interruptive function call when "Mute User" action on message gets called, and has been removed in v4.
Please check (Mute User Action)[#mute-user-action] section for details.

### `quotedRepliesEnabled`

This prop was used to configure visibility of "Reply" action within message overlay.
In v4 you can provide a prop [`overrideOwnCapabilities`](../core-components/channel.mdx#overrideowncapabilities) on Channel component to achieve the same result.

```tsx
<Channel
  overrideOwnCapabilities={{
    quoteMessage: false
  }}
>
```

### `reactionsEnabled`

This prop was used to configure visibility of reaction selector within overlay.
In v4 you can provide a prop [`overrideOwnCapabilities`](../core-components/channel.mdx#overrideowncapabilities) on Channel component to achieve the same result.

```tsx
<Channel
  overrideOwnCapabilities={{
    sendReactions: false
  }}
>
```

### `readEventsEnabled`

This prop was used to configure visibility of read receipts for message.
In v4 you can provide a prop [`overrideOwnCapabilities`](../core-components/channel.mdx#overrideowncapabilities) on Channel component to achieve the same result.

```tsx
<Channel
  overrideOwnCapabilities={{
    readEvents: false
  }}
>
```

### `threadRepliesEnabled`

This prop was used to configure visibility of "Thread Reply" action within message overlay.
In v4 you can provide a prop [`overrideOwnCapabilities`](../core-components/channel.mdx#overrideowncapabilities) on Channel component to achieve the same result.

```tsx
<Channel
  overrideOwnCapabilities={{
    sendReply: false
  }}
>
```

### `typingEventsEnabled`

This prop was used to configure visibility of "Typing Indicator" within `MessageList`.
In v4 you can provide a prop [`overrideOwnCapabilities`](../core-components/channel.mdx#overrideowncapabilities) on Channel component to achieve the same result.

```tsx
<Channel
  overrideOwnCapabilities={{
    sendTypingEvents: false
  }}
>
```

### `uploadsEnabled`

This prop was used to configure visibility of `AttachButton` within `MessageInput`.
In v4 you can provide a prop [`overrideOwnCapabilities`](../core-components/channel.mdx#overrideowncapabilities) on Channel component to achieve the same result.

```tsx
<Channel
  overrideOwnCapabilities={{
    uploadFile: false
  }}
>
```

### `animatedLongPress`

This prop was used to disabled the pop-in-out animation of message bubble when long pressed.
Support for this prop has been dropped from v4 of SDK for performance reason. For more details,
please take a look at description of PR [#987](https://github.com/GetStream/stream-chat-react-native/pull/987)

### `onDoubleTapMessage`

This prop was used to add double tap handler for message component.
Support for this prop has been dropped from v4 of SDK for performance reason. For more details,
please take a look at description of PR [#987](https://github.com/GetStream/stream-chat-react-native/pull/987)

For implementing double tap handler on message bubble please take a look at example mentioned in our [docs](../guides/message_customizations.mdx#instagram-style-double-tap-reaction)

### `messageActions`

This prop is used to customize the actions available on message within overlay. Its a function which return an array
of actions. Since v4 this function won't receive following properties on its parameter object:

- `canModifyMessage`
- `mutesEnabled`
- `reactionsEnabled`
- `threadRepliesEnabled`
- `quotedRepliesEnabled`

Instead a new property has been added - `ownCapabilities` to check availability of feature for current user
Please check the docs of [message action customization](../guides/message_actions_customization.mdx#how-to-add-a-custom-message-action) for example.

### `blockUser`

This prop was used to remove "Block User" action from message actions, and has been removed in v4.
Please check the [guide](../guides/message_actions_customization.mdx#how-to-disable-a-message-action) for disabling certain message action in v4

### `copyMessage`

This prop was used to remove "Copy Message" action from message actions, and has been removed in v4.
Please check the [guide](../guides/message_actions_customization.mdx#how-to-disable-a-message-action) for disabling certain message action in v4

### `deleteMessage`

This prop was used to remove "Delete Message" action from message actions, and has been removed in v4.
Please check the [guide](../guides/message_actions_customization.mdx#how-to-disable-a-message-action) for disabling certain message action in v4

### `editMessage`

This prop was used to remove "Edit Message" action from message actions, and has been removed in v4.
Please check the [guide](../guides/message_actions_customization.mdx#how-to-disable-a-message-action) for disabling certain message action in v4

### `flagMessage`

This prop was used to remove "Flag Message" action from message actions, and has been removed in v4.
Please check the [guide](../guides/message_actions_customization.mdx#how-to-disable-a-message-action) for disabling certain message action in v4

### `quotedReply`

This prop was used to remove "Reply" action from message actions, and has been removed in v4.
Please check the [guide](../guides/message_actions_customization.mdx#how-to-disable-a-message-action) for disabling certain message action in v4

### `retry`

This prop was used to remove "Resend" action from message actions, and has been removed in v4.
Please check the [guide](../guides/message_actions_customization.mdx#how-to-disable-a-message-action) for disabling certain message action in v4

### `threadReply`

This prop was used to remove "Thread Reply" action from message actions, and has been removed in v4.
Please check the [guide](../guides/message_actions_customization.mdx#how-to-disable-a-message-action) for disabling certain message action in v4

## Mute User Action

In v4 "Mute User" action has been removed from the SDK, since its not exactly an action on message and is not
the right place for it.
If the business requirements of application needs this message action, then please add it by customizing `messageActions`
prop as mentioned in [example](../guides/message_actions_customization.mdx#how-to-add-a-custom-message-action)

## Update The Dependencies

Since v4, peer dependency `react-native-blur` has been removed from the SDK. Blur background of overlay has been
replaced with opacity based background instead. So unless this dependency is used explicitely within application, it
can be safely removed.

```sh
yarn remove react-native-blur
npx pod-install
```

## Whats new in v4?

### Slow Mode Feature

- Slow mode helps reduce noise on a channel by limiting users to a maximum of 1 message per cooldown interval.
  Slow mode is disabled by default and can be enabled/disabled via the Dashboard, using the Chat Explorer.

  For more details, please check the documentation for slow mode - https://getstream.io/chat/docs/javascript/slow_mode/?language=javascript#channel-slow-mode

- When cooldown interval kicks in, `SendButton` (to send message) will be replaced with a countdown timer
  This countdown timer can be customized using a prop on Channel component - `CooldownTimer`

<!-- TODO: Add video recording of slow mode feature -->

### Pin Message Feature

"Pin Message" action within overlay now allows you to pin a message to channel.

<div style={{ display: 'flex', flexWrap: 'wrap', justifyContent: 'space-around' }}>
  <img src={pinMessageAction} alt='Unthemed' width='280' style={{ objectFit: 'contain', paddingBottom: '8px' }} />
  <img src={pinnedMessage} alt='Themed' width='280' style={{ objectFit: 'contain', paddingBottom: '8px' }} />
</div>

### Better Handlings Of User Capabilities on Channel

Features and UI components have been configured to use the `own_capabilities` returned by backend, improving the consistency
between SDK features and permissions/config/settings applied on application. To read more about these capabilities, please follow the documentation - https://getstream.io/chat/docs/javascript/channel_capabilities/

### UI/UX Changes and Performance Improvements

- Background for the overlay which opens up when user long-presses on a message, has been replaced with
  opacity based background instead of [BlurView](https://github.com/Kureev/react-native-blur) [#874](https://github.com/GetStream/stream-chat-react-native/pull/874)
  This dependency caused a lot of issues due to its underlying native [BlurView](https://github.com/Dimezis/BlurView) dependency.
  Thus we decided to get rid of this hurdle by dropping this peer dependency.

- `react-native-reanimated` based animations have been removed from Message component for performance reason [#987](https://github.com/GetStream/stream-chat-react-native/pull/987).
  - Long press animation on message UI has been removed
  - `animatedLongPress` prop has been removed from `Channel` component.

### Improved Customizability

#### Autocomplete suggestions

Following two new props on `Channel` componenent allows customizing UI for autocomplete suggestions list:

- `AutoCompleteSuggestionsList`
- `AutoCompleteSuggestionsListItem`

#### Message Actions

Following two new props on `OverlayProvider` component allows customizing UI for message actions:

- `MessageActionList`
- `MessageActionListItem`

Additionally styles of the message actions can be customized using following new theme keys:

```tsx
overlay: {
  messageActions: {
    actionContainer: ViewStyle;
    icon: ViewStyle;
    title: TextStyle;
  }
}
```

A seperate guide has been added to documentation for details of [How To Customize Message Actions UI](../guides/message_actions_customization.mdx#how-to-customize-message-action-ui)

#### Deleted Messages

Visibility of deleted messages can be configured using a prop `deletedMessagesVisibilityType` on Channel component.

```tsx
<Channel deletedMessagesVisibilityType={'never'} />
```

This prop has following 4 possible values:

- `always`: The deleted messages in the channel will be visible to both the sender and receiver.
- `never`: The deleted messages will not be visible to anyone.
- `sender`: The deleted messages in the channel will only be visible to sender.
- `receiver`: The deleted messages in the channel will only be visible to receiver.
