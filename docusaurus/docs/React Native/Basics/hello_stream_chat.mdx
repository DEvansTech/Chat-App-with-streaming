---
title: Hello Stream Chat
sidebar_position: 2
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

Adding feature rich chat to a React Native application can be quite challenging when starting from scratch.
There are many considerations, states, and edge cases that need need accounting for, styling, message grouping, read states, context menus, etc. all add to the complexity of the challenge.
Stream Chat for React Native provides an easy to implement flexible solution.

Stream Chat for React Native provides a way to add chat to an existing or new application with very little code.
The library was built with flexibility and customization in mind, starting with the out of the box form and function one would expect from a chat app you can modify the UI and UX as desired.

Before starting make sure you have installed `stream-chat-react-native` as directed in the [getting started](/chat/docs/sdk/React%20Native) guide.

## Creating a Chat Client

Stream Chat for React Native uses [`stream-chat`](https://github.com/GetStream/stream-chat-js), Stream's JavaScript client, to interact with Stream's chat services.
`stream-chat` is a dependency of Stream Chat for React Native so it is can be used once `stream-chat-react-native` is installed.

To start you must get an instance of Stream Chat, for this you will need an api key.
To create one you can sign up for a [free 30-day trial](https://getstream.io/chat/trial/) of Stream Chat, no CC is required.

```typescript
import { StreamChat } from 'stream-chat'; 

const client = StreamChat.getInstance('api_key');
```

:::note
Usage of `StreamChat.getInstance()` available since stream-chat@2.12.0.
<br />
This new Singleton pattern allows you to instantiate a unique StreamChat client, i.e create a StreamChat instance and retrieve it wherever you need it on your app to perform API calls.
After calling it once, any following <code>getInstance</code> call will return the initial StreamChat instance.
This will prevent you from accidentally creating multiple StreamChat instances, opening multiple WebSockets, and driving up your concurrent connections unnecessarily.
<br /><br />

Stream Chat is backward compatible. Users can continue using <code>new StreamChat()</code> if desired.

```typescript
const client = new StreamChat('api_key');
```
:::

There are multiple ways to access the client throughout your application. You can store the client in a [`context`](https://reactjs.org/docs/context.html).
Create your own class. Or using the Singleton structure you can call `getInstance` when required.

## Connecting a User

Tokens are used to authenticate a user.
Typically, you send this token from your backend to the client when a user registers or logs in.
See the <!-- TODO: Change to new docs -->[Tokens & Authentication](https://getstream.io/chat/docs/javascript/tokens_and_authentication/) documentation to learn more about creating tokens.
For the purpose of this guide we will assume you have created and retrieved a `user_token`.

To connect a user a the `connectUser` function should be called and provided with the user object and `user_token`.
Connecting a user could be done in the login flow or elsewhere in the application after the client is instantiated.  

```typescript
await client.connectUser( 
    { 
        id: 'jlahey', 
        name: 'Jim Lahey', 
        image: 'https://i.imgur.com/fR9Jz14.png', 
    }, 
    'user_token',
); 
```

It is recommended to not repeatedly call `connectUser` unnecessarily, multiple calls to `connectUser` will result in warnings, and attempting to call `connectUser` before disconnecting a current user will throw an Error.

To disconnect a user you can call `disconnect` on the client.

```typescript
await client.disconnect();
```

## Creating a Channel

Channels are at the core of Stream Chat, they are where messages are contained, sent, and interacted with.
Before delving into the UI components we need to make sure we have a channel to display.
Let’s start by initializing one.

A <!-- TODO: Change to new docs -->[channel type](https://getstream.io/chat/docs/react-native/channel_features/) is required for creating a channel and controls the settings for a given channel.
There are 5 default types of channels.

- `commerce`
- `gaming`
- `livestream`
- `messaging`
- `team`

These five options provide you with sensible defaults for the named use cases.
You can also define custom channel types if Stream Chat defaults don’t work for your use case.

A channel must be initialized with either an `id` or a list of members for the channel.
If you provide a list of members an `id` will be auto-generated on backend for the channel.

:::note
You can't add or remove members from channel created using a list of members.
:::

You can also add additional custom data to a channel.
You can add as many custom fields as you desire as long as the total size of the custom fields object is *less than 5KB*.

For the purpose of this guide you should create a `channel` as you see fit utilizing either a members list that includes your user's `id`, or a channel `id`.
**This can be done once then the code removed** as we won't be covering on the fly channel creation in this guide.

<Tabs
  defaultValue='channelId'
  values={[
    { label: 'Channel Id', value: 'channelId' },
    { label: 'Members List', value: 'members' },
  ]}
>
<TabItem value='channelId'>

  ```typescript
  /**
   *  Channel created using a channel id
   */
  const channel = client.channel('messaging', 'the_park', { 
      name: 'The Park', 
  });
  ```

</TabItem>
<TabItem value='members'>

  ```typescript
  /**
   *  Channel created using a members list
   */
  const channel = client.channel('messaging', {
      members: ['jlahey', 'rlafleur']
      name: 'The Park', 
  });
  ```

</TabItem>
</Tabs>

To create this channel on the server you must call `create` on the new channel instance.

```typescript
await channel.create()
```

:::note
For on the fly channel creation you would instead call the `watch` function on the channel as this both creates the channel and subscribes the client to channel updates.
:::

## Configuring UI Components

Now that you have a `client` instance, a user set, and a channel created on the server you can setup your project to use the UI components.

All major `stream-chat-react-native` components rely on `contexts` to function properly.
The UI and functionality are heavily controlled by a number of components that contain [`Providers`](https://reactjs.org/docs/context.html#contextprovider) to give access to these `contexts`.

### OverlayProvider

The `OverlayProvider` is the highest level of the Stream Chat components.
The `OverlayProvider` allows users to interact with messages on long press above the underlying views, use the full screen image viewer, and use the `AttachmentPicker` as a keyboard-esk view.

The `OverlayProvider` can be used with no props provided but there are a plethora of props for customizing the components in the overlay.
To use the `OverlayProvider` with no props `setTopInset` must be called at a later point in time, typically when the header height for the chat screen is known.
For the purpose of this guide we will assume there is no header and provide the `topInset` as a prop with a value of `0`.

For additional information on the `OverlayProvider` check the [OverlayProvider docs](<!-- TODO: Change to new docs -->) for detailed usage instructions, including how to properly use the `OverlyProvider` with [React Navigation](https://reactnavigation.org/).

```tsx
import { OverlayProvider } from 'stream-chat-react-native';

export const Screen = () =>
  <OverlayProvider
    topInset={0}
  >
    {/** App components */}
  </OverlayProvider>
```

### Chat

`Chat` is the next level down of context component from `OverlyProvider` that is required for `stream-chat-react-native` to function as designed.
You can choose to wrap your entire application in `Chat` similar to what is required for the `OverlayProvider` or you can implement `Chat` at the screen level.
`Chat` has one required prop, `client`, which is the instance of `StreamChat` [you created](#creating-a-chat-client).

For additional information on the `Chat` component check the [Chat component docs](<!-- TODO: Change to new docs -->) for detailed usage instructions, including how to provide theming and translations to the app.

<Tabs
  defaultValue='app'
  values={[
    { label: 'App', value: 'app' },
    { label: 'Screen', value: 'screen' },
  ]}
>
<TabItem value='app'>

  ```tsx
  import { StreamChat } from 'stream-chat'; 
  import { Chat, OverlayProvider } from 'stream-chat-react-native';

  const client = StreamChat.getInstance('api_key');

  export const App = () =>
    <OverlayProvider
      topInset={0}
    >
      <Chat client={client}>
        {/** App components */}
      </Chat>
    </OverlayProvider>
  ```

</TabItem>
<TabItem value='screen'>

  ```typescript
  import { StreamChat } from 'stream-chat'; 
  import { Chat } from 'stream-chat-react-native';

  const client = StreamChat.getInstance('api_key');

  export const Screen = () =>
    <Chat client={client}>
      {/** App components */}
    </Chat>
  ```

  ```typescript
  import { OverlayProvider } from 'stream-chat-react-native';
  import { Screen } from './Screen'

  export const App = () =>
    <OverlayProvider
      topInset={0}
    >
      <Screen />
    </OverlayProvider>
  ```

</TabItem>
</Tabs>

## Channel List

Stream Chat for React Native provides a `ChannelList` component out of the box for displaying a list of channels.
`ChannelList` can be used with no props and will return all of the channels the set user has access to.
To functionally use the `ChannelList` an `onSelect` prop should be provided.
The `onSelect` function is called with the selected `Channel` instance and can then be used to react to the user interaction, e.g. store the `Channel` in state and navigate to the appropriate channel screen.

For additional information on the `ChannelList` component check the [ChannelList component docs](<!-- TODO: Change to new docs -->), these include instructions on how to filter and sort the `ChannelList`.

The `ChannelList` should be implemented inside of the UI components [previously configured](#configuring-ui-components) to provide the appropriate `contexts`.
For the purpose of this guide we will continue to give the example implementation in a single component with the assumption that the client has already been instantiated, a user connected, and a channel the user has access to exists.

```tsx
import { StreamChat } from 'stream-chat'; 
import { ChannelList, Chat, OverlayProvider } from 'stream-chat-react-native';

const client = StreamChat.getInstance('api_key');

export const App = () =>
  <OverlayProvider
    topInset={0}
  >
    <Chat client={client}>
      <ChannelList />
    </Chat>
  </OverlayProvider>
```

These three components in conjunction will provide a [`FlatList`](https://reactnative.dev/docs/flatlist) of all channels available to the connected user.

## Channel

When creating a chat screen it is required that the `Channel` component wrap the `stream-chat-react-native` components being used.
`Channel` provides multiple `contexts` to the enclosed components and allows for modification and replacement of many of the components.
Channel is the major entry point for modifying the look and feel of your chat application.
For additional information on the `Channel` component, how to modify various features, adjusting for keyboard offsets, and more, check the [Channel component docs.](<!-- TODO: Change to new docs -->)

The `Channel` component does not require any props, but will not function as desired without the `channel` prop being provided.
The `channel` prop expects a `StreamChat` `Channel` instance.
This can be created [as you did previously](#creating-a-channel), pulled directly from the `client` instance, or conveniently stored when a channel is selected from the `ChannelList`. 

### 